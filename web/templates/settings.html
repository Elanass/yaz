{% extends "layout.html" %}

{% block head %}
<title>Settings - Gastric ADCI Platform</title>
<meta name="description" content="User settings and platform preferences">
{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto p-6">
    <!-- Settings Header -->
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-[var(--text-primary)] mb-2">Settings</h1>
        <p class="text-[var(--text-secondary)]">Manage your preferences and platform configuration</p>
    </div>

    {% if error %}
    <div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6">
        <p><strong>Error:</strong> {{ error }}</p>
    </div>
    {% endif %}

    <div class="grid gap-6 lg:grid-cols-3">
        <!-- Settings Navigation -->
        <div class="lg:col-span-1">
            <nav class="space-y-2">
                <a href="#profile" class="settings-nav-item active flex items-center gap-3 px-4 py-3 rounded-lg bg-[var(--bg-secondary)] text-[var(--text-primary)]">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 256 256">
                        <path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24ZM74.08,197.5a64,64,0,0,1,107.84,0,87.83,87.83,0,0,1-107.84,0ZM96,120a32,32,0,1,1,32,32A32,32,0,0,1,96,120Zm97.76,66.41a79.66,79.66,0,0,0-36.06-28.75,48,48,0,1,0-59.4,0,79.66,79.66,0,0,0-36.06,28.75,88,88,0,1,1,131.52,0Z"></path>
                    </svg>
                    Profile Settings
                </a>
                <a href="#preferences" class="settings-nav-item flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-[var(--bg-secondary)] text-[var(--text-secondary)]">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 256 256">
                        <path d="M128,80a48,48,0,1,0,48,48A48.05,48.05,0,0,0,128,80Zm0,80a32,32,0,1,1,32-32A32,32,0,0,1,128,160Zm88-29.84q.06-2.16,0-4.32l14.92-18.64a8,8,0,0,0,1.48-7.06,107.6,107.6,0,0,0-10.88-26.25,8,8,0,0,0-6-3.93l-23.72-2.64q-1.48-1.56-3.06-3.05L221.84,40.9a8,8,0,0,0-3.94-6A107.29,107.29,0,0,0,191.68,24a8,8,0,0,0-7.06,1.49L166,40.42q-2.16-.06-4.32,0L143,25.58a8,8,0,0,0-7.06-1.49A107.6,107.6,0,0,0,109.7,34.9a8,8,0,0,0-3.93,6L102.12,64.64q-1.56,1.49-3.05,3.06L74.9,34.16a8,8,0,0,0-6,3.94A107.71,107.71,0,0,0,58,64.32a8,8,0,0,0,1.49,7.06L74.42,90q-.06,2.16,0,4.32L59.58,113a8,8,0,0,0-1.49,7.06A107.6,107.6,0,0,0,68.9,146.3a8,8,0,0,0,6,3.93l23.72,2.64q1.49,1.56,3.06,3.05L68.16,181.1a8,8,0,0,0,3.94,6,107.29,107.29,0,0,0,26.22,10.83,8,8,0,0,0,7.06-1.49L124,181.58q2.16.06,4.32,0L147,196.42a8,8,0,0,0,7.06,1.49,107.6,107.6,0,0,0,26.25-10.88,8,8,0,0,0,3.93-6l2.64-23.72q1.56-1.48,3.05-3.06l25.17,33.48a8,8,0,0,0,6-3.94,107.71,107.71,0,0,0,10.83-26.22,8,8,0,0,0-1.49-7.06Z"></path>
                    </svg>
                    Preferences
                </a>
                <a href="#security" class="settings-nav-item flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-[var(--bg-secondary)] text-[var(--text-secondary)]">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 256 256">
                        <path d="M208,80H176V56a48,48,0,0,0-96,0V80H48A16,16,0,0,0,32,96V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V96A16,16,0,0,0,208,80ZM96,56a32,32,0,0,1,64,0V80H96ZM208,208H48V96H208V208Zm-68-56a12,12,0,1,1-12-12A12,12,0,0,1,140,152Z"></path>
                    </svg>
                    Security
                </a>
                <a href="#system" class="settings-nav-item flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-[var(--bg-secondary)] text-[var(--text-secondary)]">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 256 256">
                        <path d="M232,208a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V48a8,8,0,0,1,16,0V156.69L100.69,96a8,8,0,0,1,11.31,0L128,112l50.34-50.34a8,8,0,0,1,11.32,11.31L139.31,123.31a8,8,0,0,1-11.31,0L112,107.31,56,163.31V200H224A8,8,0,0,1,232,208Z"></path>
                    </svg>
                    System Info
                </a>
            </nav>
        </div>

        <!-- Settings Content -->
        <div class="lg:col-span-2">
            <!-- Profile Settings -->
            <div id="profile" class="settings-section">
                <div class="bg-[var(--bg-primary)] border border-[var(--border-color)] rounded-lg p-6">
                    <h2 class="text-xl font-semibold text-[var(--text-primary)] mb-4">Profile Settings</h2>
                    
                    <form class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Display Name</label>
                            <input type="text" class="w-full px-3 py-2 border border-[var(--border-color)] rounded-lg bg-[var(--bg-secondary)] text-[var(--text-primary)] focus:outline-none focus:ring-2 focus:ring-blue-400" value="Dr. Surgeon">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Email</label>
                            <input type="email" class="w-full px-3 py-2 border border-[var(--border-color)] rounded-lg bg-[var(--bg-secondary)] text-[var(--text-primary)] focus:outline-none focus:ring-2 focus:ring-blue-400" value="surgeon@hospital.com">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2">Specialty</label>
                            <select class="w-full px-3 py-2 border border-[var(--border-color)] rounded-lg bg-[var(--bg-secondary)] text-[var(--text-primary)] focus:outline-none focus:ring-2 focus:ring-blue-400">
                                <option value="gastrointestinal" selected>Gastrointestinal Surgery</option>
                                <option value="cardiovascular">Cardiovascular Surgery</option>
                                <option value="orthopedic">Orthopedic Surgery</option>
                                <option value="neurosurgery">Neurosurgery</option>
                                <option value="urologic">Urologic Surgery</option>
                            </select>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Preferences -->
            <div id="preferences" class="settings-section hidden">
                <div class="bg-[var(--bg-primary)] border border-[var(--border-color)] rounded-lg p-6">
                    <h2 class="text-xl font-semibold text-[var(--text-primary)] mb-4">Preferences</h2>
                    
                    <div class="space-y-6">
                        <!-- Theme Settings -->
                        <div>
                            <h3 class="font-medium text-[var(--text-primary)] mb-3">Appearance</h3>
                            <div class="flex items-center justify-between">
                                <span class="text-[var(--text-secondary)]">Theme</span>
                                <select class="px-3 py-2 border border-[var(--border-color)] rounded-lg bg-[var(--bg-secondary)] text-[var(--text-primary)]">
                                    <option value="light" {% if user_preferences.theme == 'light' %}selected{% endif %}>Light</option>
                                    <option value="dark" {% if user_preferences.theme == 'dark' %}selected{% endif %}>Dark</option>
                                    <option value="auto">Auto</option>
                                </select>
                            </div>
                        </div>

                        <!-- Notifications -->
                        <div>
                            <h3 class="font-medium text-[var(--text-primary)] mb-3">Notifications</h3>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between">
                                    <span class="text-[var(--text-secondary)]">Email Notifications</span>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only peer" {% if user_preferences.notifications %}checked{% endif %}>
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-400"></div>
                                    </label>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-[var(--text-secondary)]">Auto-save Cases</span>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only peer" {% if user_preferences.auto_save %}checked{% endif %}>
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-400"></div>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- System Info -->
            <div id="system" class="settings-section hidden">
                <div class="bg-[var(--bg-primary)] border border-[var(--border-color)] rounded-lg p-6">
                    <h2 class="text-xl font-semibold text-[var(--text-primary)] mb-4">System Information</h2>
                    
                    <div class="space-y-4">
                        <div class="flex justify-between">
                            <span class="text-[var(--text-secondary)]">Platform Version</span>
                            <span class="text-[var(--text-primary)] font-medium">{{ system_settings.version or '2.0.0' }}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-[var(--text-secondary)]">Security Level</span>
                            <span class="text-green-600 font-medium">{{ system_settings.security_level or 'High' }}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-[var(--text-secondary)]">Backup Status</span>
                            <span class="text-green-600 font-medium">{% if system_settings.backup_enabled %}Enabled{% else %}Disabled{% endif %}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-[var(--text-secondary)]">Maintenance Mode</span>
                            <span class="{% if system_settings.maintenance_mode %}text-orange-600{% else %}text-green-600{% endif %} font-medium">
                                {% if system_settings.maintenance_mode %}Active{% else %}Inactive{% endif %}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Save Button -->
    <div class="mt-8 flex justify-end">
        <button type="button" class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
            Save Changes
        </button>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Settings navigation
    const navItems = document.querySelectorAll('.settings-nav-item');
    const sections = document.querySelectorAll('.settings-section');

    navItems.forEach(item => {
        item.addEventListener('click', function(e) {
            e.preventDefault();
            
            // Remove active class from all nav items
            navItems.forEach(nav => {
                nav.classList.remove('active', 'bg-[var(--bg-secondary)]', 'text-[var(--text-primary)]');
                nav.classList.add('text-[var(--text-secondary)]');
            });
            
            // Add active class to clicked item
            this.classList.add('active', 'bg-[var(--bg-secondary)]', 'text-[var(--text-primary)]');
            this.classList.remove('text-[var(--text-secondary)]');
            
            // Hide all sections
            sections.forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show target section
            const target = this.getAttribute('href').substring(1);
            const targetSection = document.getElementById(target);
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
        });
    });
});
</script>
{% endblock %}
