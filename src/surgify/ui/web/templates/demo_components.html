{% extends "base.html" %}

{% block title %}Component Demo - Surgify{% endblock %}

{% block extra_head %}
<style>
    .demo-section {
        margin-bottom: 3rem;
        padding: 2rem;
        border: 1px solid #e5e5e5;
        border-radius: 8px;
        background: white;
    }
    .demo-title {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: #1f2937;
        border-bottom: 2px solid #3b82f6;
        padding-bottom: 0.5rem;
    }
    .demo-description {
        color: #6b7280;
        margin-bottom: 1.5rem;
        font-size: 0.9rem;
    }
    .demo-code {
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 4px;
        padding: 1rem;
        margin-top: 1rem;
        font-family: 'Monaco', 'Consolas', monospace;
        font-size: 0.85rem;
        overflow-x: auto;
    }
</style>
{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50">
    <!-- Header -->
    <div class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center space-x-4">
                    <button id="sidepanel-toggle" class="p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                    <h1 class="text-xl font-semibold text-gray-900">Component Library Demo</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Notification Badge Demo in Header -->
                    <div id="header-notifications">
                        <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5-5-5h5v-5h5l-5-5-5 5h5v5z"></path>
                        </svg>
                    </div>
                    <!-- Theme Toggle in Header -->
                    <div id="header-theme-toggle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
        
        <!-- Introduction -->
        <div class="demo-section">
            <h2 class="demo-title">ðŸŽ¨ Surgify Component Library</h2>
            <div class="demo-description">
                <p>This page demonstrates all the reusable UI components available in the Surgify platform. Each component is built with:</p>
                <ul class="list-disc list-inside mt-2 space-y-1">
                    <li>Plain HTML structure with Tailwind CSS styling</li>
                    <li>Minimal JavaScript with HTMX integration hooks</li>
                    <li>Responsive design and accessibility features</li>
                    <li>Customizable options and event handling</li>
                </ul>
            </div>
        </div>

        <!-- Domain Selector Demo -->
        <div class="demo-section">
            <h2 class="demo-title">ðŸŽ¯ Domain Selector</h2>
            <div class="demo-description">
                A dropdown component for selecting medical domains with search functionality and HTMX support.
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Basic Domain Selector:</label>
                    <div id="domain-selector-demo1" class="max-w-md"></div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Pre-selected with Custom Domains:</label>
                    <div id="domain-selector-demo2" class="max-w-md"></div>
                </div>
            </div>

            <div class="demo-code">
// Initialize Domain Selector
const selector = new DomainSelector('domain-selector-demo1', {
    domains: ['Gastric Surgery', 'Oncology', 'Pathology', 'Radiology'],
    placeholder: 'Select a medical domain...',
    onSelect: (domain) => console.log('Selected:', domain)
});
selector.render();
            </div>
        </div>

        <!-- Case List Demo -->
        <div class="demo-section">
            <h2 class="demo-title">ðŸ“‹ Case List</h2>
            <div class="demo-description">
                A comprehensive list component with search, filtering, and pagination capabilities.
            </div>
            
            <div id="case-list-demo" class="mt-4"></div>

            <div class="demo-code">
// Initialize Case List
const caseList = new CaseList('case-list-demo', {
    cases: sampleCases,
    showSearch: true,
    showFilters: true,
    pageSize: 5,
    onCaseSelect: (caseData) => caseDetail.setCase(caseData)
});
caseList.render();
            </div>
        </div>

        <!-- Case Detail Demo -->
        <div class="demo-section">
            <h2 class="demo-title">ðŸ“„ Case Detail</h2>
            <div class="demo-description">
                A detailed view component with tabs, editing capabilities, and action buttons.
            </div>
            
            <div id="case-detail-demo" class="mt-4 border border-gray-200 rounded-lg"></div>

            <div class="demo-code">
// Initialize Case Detail
const caseDetail = new CaseDetail('case-detail-demo', {
    case: selectedCase,
    showTabs: true,
    showActions: true,
    editable: true
});
caseDetail.render();
            </div>
        </div>

        <!-- Notification Badge Demo -->
        <div class="demo-section">
            <h2 class="demo-title">ðŸ”” Notification Badge</h2>
            <div class="demo-description">
                Notification badges that can be attached to any element with different styles and colors.
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="text-center">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Default Badge:</label>
                    <div id="badge-demo1" class="inline-block">
                        <button class="px-4 py-2 bg-blue-600 text-white rounded-lg">Messages</button>
                    </div>
                </div>
                
                <div class="text-center">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Success Badge:</label>
                    <div id="badge-demo2" class="inline-block">
                        <button class="px-4 py-2 bg-green-600 text-white rounded-lg">Completed</button>
                    </div>
                </div>
                
                <div class="text-center">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Warning Badge:</label>
                    <div id="badge-demo3" class="inline-block">
                        <button class="px-4 py-2 bg-yellow-600 text-white rounded-lg">Pending</button>
                    </div>
                </div>
                
                <div class="text-center">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Danger Badge:</label>
                    <div id="badge-demo4" class="inline-block">
                        <button class="px-4 py-2 bg-red-600 text-white rounded-lg">Errors</button>
                    </div>
                </div>
            </div>

            <div class="mt-6 flex justify-center space-x-4">
                <button id="increment-badges" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                    Increment All Badges
                </button>
                <button id="reset-badges" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700">
                    Reset All Badges
                </button>
            </div>

            <div class="demo-code">
// Initialize Notification Badge
const badge = new NotificationBadge('badge-demo1', {
    count: 3,
    type: 'default',
    size: 'medium',
    position: 'top-right'
});
badge.render();
            </div>
        </div>

        <!-- Theme Toggle Demo -->
        <div class="demo-section">
            <h2 class="demo-title">ðŸŒ“ Theme Toggle</h2>
            <div class="demo-description">
                Theme switching components with different styles and automatic system theme detection.
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="text-center">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Switch Style:</label>
                    <div id="theme-toggle-demo1"></div>
                </div>
                
                <div class="text-center">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Button Style:</label>
                    <div id="theme-toggle-demo2"></div>
                </div>
                
                <div class="text-center">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Icon Style:</label>
                    <div id="theme-toggle-demo3"></div>
                </div>
            </div>

            <div class="demo-code">
// Initialize Theme Toggle
const themeToggle = new ThemeToggle('theme-toggle-demo1', {
    style: 'switch',
    showLabel: true,
    onChange: (theme) => console.log('Theme changed to:', theme)
});
themeToggle.render();
            </div>
        </div>

        <!-- Integration Demo -->
        <div class="demo-section">
            <h2 class="demo-title">ðŸ”— Component Integration</h2>
            <div class="demo-description">
                Demonstration of how components work together in a real-world scenario.
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="lg:col-span-1">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Filters & Controls</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Domain Filter:</label>
                            <div id="integration-domain-selector"></div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium text-gray-700">Theme:</span>
                            <div id="integration-theme-toggle"></div>
                        </div>
                    </div>
                </div>
                
                <div class="lg:col-span-2">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Case Management</h3>
                    <div id="integration-case-list"></div>
                </div>
            </div>
        </div>

    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Sample data
    const sampleCases = [
        {
            id: 1,
            title: "Gastric Adenocarcinoma Case #001",
            description: "65-year-old patient with advanced gastric cancer",
            status: "active",
            patient: "John Smith",
            physician: "Dr. Jane Wilson",
            date: "2024-01-15",
            department: "Oncology",
            priority: "High",
            diagnosis: "Gastric Adenocarcinoma Stage III",
            symptoms: "Abdominal pain, weight loss, nausea",
            age: 65,
            gender: "Male",
            notes: [
                {
                    id: 1,
                    content: "Initial consultation completed. Staging workup ordered.",
                    author: "Dr. Jane Wilson",
                    date: "2024-01-15T10:30:00Z"
                }
            ]
        },
        {
            id: 2,
            title: "Peptic Ulcer Case #002",
            description: "Chronic peptic ulcer disease with complications",
            status: "pending",
            patient: "Mary Johnson",
            physician: "Dr. Robert Chen",
            date: "2024-01-14",
            department: "Gastroenterology",
            priority: "Medium"
        },
        {
            id: 3,
            title: "Post-operative Follow-up #003",
            description: "Post-surgical monitoring and recovery assessment",
            status: "completed",
            patient: "David Brown",
            physician: "Dr. Sarah Davis",
            date: "2024-01-13",
            department: "Surgery",
            priority: "Low"
        },
        {
            id: 4,
            title: "Gastric Perforation #004",
            description: "Emergency case with gastric perforation",
            status: "active",
            patient: "Lisa Anderson",
            physician: "Dr. Michael Lee",
            date: "2024-01-16",
            department: "Emergency Surgery",
            priority: "Critical"
        },
        {
            id: 5,
            title: "Routine Screening #005",
            description: "Annual gastric cancer screening",
            status: "completed",
            patient: "Tom Wilson",
            physician: "Dr. Emily Clark",
            date: "2024-01-12",
            department: "Preventive Care",
            priority: "Low"
        }
    ];

    // Initialize Domain Selectors
    const domainSelector1 = new DomainSelector('domain-selector-demo1', {
        domains: ['Gastric Surgery', 'Oncology', 'Pathology', 'Radiology'],
        placeholder: 'Select a medical domain...',
        onSelect: (domain) => {
            console.log('Domain selected:', domain);
            // Show a brief notification
            const container = document.getElementById('domain-selector-demo1');
            const notification = document.createElement('div');
            notification.className = 'mt-2 p-2 bg-green-100 text-green-800 rounded text-sm';
            notification.textContent = `Selected: ${domain}`;
            container.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }
    });
    domainSelector1.render();

    const domainSelector2 = new DomainSelector('domain-selector-demo2', {
        domains: ['Gastric Surgery', 'Oncology', 'Pathology', 'Radiology', 'Cardiology', 'Neurology'],
        selectedDomain: 'Oncology',
        placeholder: 'Choose domain...'
    });
    domainSelector2.render();

    // Initialize Case List
    const caseList = new CaseList('case-list-demo', {
        cases: sampleCases,
        showSearch: true,
        showFilters: true,
        pageSize: 3,
        onCaseSelect: (caseData) => {
            caseDetail.setCase(caseData);
        }
    });
    caseList.render();

    // Initialize Case Detail
    const caseDetail = new CaseDetail('case-detail-demo', {
        case: sampleCases[0],
        showTabs: true,
        showActions: true,
        editable: true
    });
    caseDetail.render();

    // Initialize Notification Badges
    const badges = {
        badge1: new NotificationBadge('badge-demo1', {
            count: 3,
            type: 'default',
            size: 'medium',
            position: 'top-right'
        }),
        badge2: new NotificationBadge('badge-demo2', {
            count: 5,
            type: 'success',
            size: 'medium',
            position: 'top-right'
        }),
        badge3: new NotificationBadge('badge-demo3', {
            count: 2,
            type: 'warning',
            size: 'medium',
            position: 'top-right'
        }),
        badge4: new NotificationBadge('badge-demo4', {
            count: 1,
            type: 'danger',
            size: 'medium',
            position: 'top-right'
        })
    };

    Object.values(badges).forEach(badge => badge.render());

    // Header notification badge
    const headerNotificationBadge = new NotificationBadge('header-notifications', {
        count: 7,
        type: 'danger',
        size: 'small',
        position: 'top-right'
    });
    headerNotificationBadge.render();

    // Badge control buttons
    document.getElementById('increment-badges').addEventListener('click', () => {
        Object.values(badges).forEach(badge => badge.increment());
        headerNotificationBadge.increment();
    });

    document.getElementById('reset-badges').addEventListener('click', () => {
        Object.values(badges).forEach(badge => badge.reset());
        headerNotificationBadge.reset();
    });

    // Initialize Theme Toggles
    const themeToggle1 = new ThemeToggle('theme-toggle-demo1', {
        style: 'switch',
        size: 'medium',
        showLabel: true
    });
    themeToggle1.render();

    const themeToggle2 = new ThemeToggle('theme-toggle-demo2', {
        style: 'button',
        size: 'small',
        autoDetect: true
    });
    themeToggle2.render();

    const themeToggle3 = new ThemeToggle('theme-toggle-demo3', {
        style: 'icon',
        size: 'medium'
    });
    themeToggle3.render();

    // Header theme toggle
    const headerThemeToggle = new ThemeToggle('header-theme-toggle', {
        style: 'icon',
        size: 'small'
    });
    headerThemeToggle.render();

    // Integration demos
    const integrationDomainSelector = new DomainSelector('integration-domain-selector', {
        domains: ['All Domains', 'Gastric Surgery', 'Oncology', 'Pathology'],
        selectedDomain: 'All Domains',
        onSelect: (domain) => {
            // Filter the case list based on selected domain
            const filteredCases = domain === 'All Domains' 
                ? sampleCases 
                : sampleCases.filter(c => c.department && c.department.toLowerCase().includes(domain.toLowerCase()));
            integrationCaseList.setCases(filteredCases);
        }
    });
    integrationDomainSelector.render();

    const integrationThemeToggle = new ThemeToggle('integration-theme-toggle', {
        style: 'switch',
        size: 'small',
        showLabel: false
    });
    integrationThemeToggle.render();

    const integrationCaseList = new CaseList('integration-case-list', {
        cases: sampleCases.slice(0, 3),
        showSearch: false,
        showFilters: false,
        showPagination: false,
        onCaseSelect: (caseData) => {
            alert(`Selected case: ${caseData.title}`);
        }
    });
    integrationCaseList.render();

    // Event listeners for component interactions
    document.addEventListener('domainSelected', (e) => {
        console.log('Domain selection event:', e.detail);
    });

    document.addEventListener('caseSelected', (e) => {
        console.log('Case selection event:', e.detail);
    });

    document.addEventListener('themeChanged', (e) => {
        console.log('Theme change event:', e.detail);
    });

    document.addEventListener('countChanged', (e) => {
        console.log('Notification count changed:', e.detail);
    });
});
</script>
{% endblock %}
